<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Crypto Dashboard - Real-Time Prices</title>
<meta name="description" content="Check live cryptocurrency prices, top gainers, losers, and market movers.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial,sans-serif; margin:0; padding:20px; background:#f5f5f5; color:#333; transition:0.3s; }
body.dark { background:#121212; color:#eee; }
h1{text-align:center;color:#ff9900;margin-bottom:15px;}
table{width:100%;border-collapse:collapse;margin-bottom:10px;background:#fff;border-radius:10px;}
body.dark table{background:#1e1e1e;color:#eee;}
th, td{padding:8px;text-align:center;border-bottom:1px solid #ddd;}
body.dark th, body.dark td{border-bottom:1px solid #555;}
tr:hover{background-color:#f0f0f0;}
body.dark tr:hover{background-color:#333;}
#floatingMovers, #sideBanner{position:fixed; background:#fff;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.2);padding:10px;font-size:14px;z-index:9999; transition:0.3s; cursor: move;}
body.dark #floatingMovers, body.dark #sideBanner{background:#1e1e1e;color:#eee;}
#floatingMovers{bottom:20px; right:20px; width:250px;}
#sideBanner{top:100px; right:0; width:160px;}
.controls{text-align:center;margin-bottom:15px;}
select, button, input{padding:8px 12px;font-size:16px;border-radius:8px;border:1px solid #ccc;cursor:pointer;}
button{margin-left:5px;}
input{width:200px;}
a{color:#ff9900;text-decoration:none;}
.ad-slot{margin:20px auto;text-align:center;}
.widget-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;}
.widget-header h3{margin:0;}
.widget-header button{
  cursor: pointer;
  border: none;
  background: transparent;
  font-size: 16px;
  font-weight: bold;
  color: #ff9900; 
  transition: color 0.2s;
}
.widget-header button:hover { color: #ff3300; }
.pagination{margin-top:5px;text-align:center;}
.pagination button{margin:2px;}
/* Smooth fade-in for table rows and lists */
#cryptoTable tbody tr, #leaderboard tbody tr, #gainersTable tbody tr, #losersTable tbody tr, #floatingMovers li {
  transition: opacity 0.3s;
}
</style>
</head>
<body>

<div class="ad-slot">
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-YOUR-CLIENT-ID"
       data-ad-slot="1111111111"
       data-ad-format="auto"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>

<h1>Crypto Dashboard</h1>

<div class="controls">
  <label for="currency">Currency:</label>
  <select id="currency"></select>
  <button id="themeToggle">Toggle Dark/Light Mode</button>
  <input type="text" id="searchInput" placeholder="Search crypto by name...">
</div>

<h2>Leaderboard - Top 10 Cryptos</h2>
<table id="leaderboard">
<thead><tr><th>Rank</th><th>Name</th><th>Price</th><th>24h %</th></tr></thead>
<tbody></tbody>
</table>

<h2>Top 5 Gainers</h2>
<table id="gainersTable"><thead><tr><th>Name</th><th>Price</th><th>24h Change</th></tr></thead><tbody></tbody></table>

<h2>Top 5 Losers</h2>
<table id="losersTable"><thead><tr><th>Name</th><th>Price</th><th>24h Change</th></tr></thead><tbody></tbody></table>

<h2>All Cryptos</h2>
<table id="cryptoTable"><thead><tr><th>#</th><th>Name</th><th>Price</th><th>24h</th><th>7d</th><th>30d</th></tr></thead><tbody></tbody></table>
<div class="pagination">
  <button id="prevPage">Previous</button>
  <span id="pageInfo">Page 1</span>
  <button id="nextPage">Next</button>
</div>

<div id="floatingMovers">
  <div class="widget-header">
    <h3>Top Movers</h3>
    <div>
      <button class="close">×</button>
    </div>
  </div>
  <ul></ul>
</div>

<div a href="http://wa.me/2349044688796" target="_blank" id="sideBanner">
  <div class="widget-header">
    <h3>Advertise Here</h3>
    <div>
      <button class="close">×</button>
    </div>
  </div>
  <p>Place your banner or link</p>
  <div class="ad-slot">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-YOUR-CLIENT-ID"
         data-ad-slot="2222222222"
         data-ad-format="auto"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>
</div>

<h2>Latest Crypto News</h2>
<ul id="cryptoNewsFeed"></ul>

<footer style="text-align:center;margin-top:20px;">
Powered by <a href="http://wa.me/2349044688796" target="_blank">Digitek Hub</a>
</footer>

<script>
const currencySelect=document.getElementById("currency");
const cryptoTable=document.getElementById("cryptoTable").querySelector("tbody");
const gainersTable=document.getElementById("gainersTable").querySelector("tbody");
const losersTable=document.getElementById("losersTable").querySelector("tbody");
const floatingMovers=document.getElementById("floatingMovers").querySelector("ul");
const leaderboardTable=document.getElementById("leaderboard").querySelector("tbody");
const newsFeed=document.getElementById("cryptoNewsFeed");
const searchInput=document.getElementById("searchInput");
const pageInfo=document.getElementById("pageInfo");
const prevBtn=document.getElementById("prevPage");
const nextBtn=document.getElementById("nextPage");

const currencies=["usd","eur","gbp"];
currencies.forEach(c=>{const o=document.createElement("option");o.value=c;o.textContent=c.toUpperCase();currencySelect.appendChild(o);});

currencySelect.addEventListener("change",()=>{currentPage=1; fetchCryptoData();});
document.getElementById("themeToggle").addEventListener("click",()=>{document.body.classList.toggle("dark");localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light");});
if(localStorage.getItem("theme")==="dark") document.body.classList.add("dark");

let allCoinsGlobal=[];
let currentPage=1;
const pageSize=50;

async function fetchCryptoData(){
  const cur=currencySelect.value;
  
  try{
    let tempAllCoins = [];
    for(let page=1; page<=5; page++){
      const res=await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=${cur}&order=market_cap_desc&per_page=100&page=${page}&sparkline=false&price_change_percentage=24h,7d,30d`);
      const data=await res.json();
      tempAllCoins = tempAllCoins.concat(data);
    }
    allCoinsGlobal = tempAllCoins;

    // --- Update Leaderboard ---
    leaderboardTable.innerHTML = "";
    allCoinsGlobal.slice(0,10).forEach(c=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`<td>${c.market_cap_rank}</td><td>${c.name}</td><td>${c.current_price.toLocaleString()}</td><td>${c.price_change_percentage_24h?.toFixed(2)||0}%</td>`;
      leaderboardTable.appendChild(tr);
    });

    // --- Update Top Gainers / Losers ---
    gainersTable.innerHTML = "";
    losersTable.innerHTML = "";
    const sorted=allCoinsGlobal.filter(c=>c.price_change_percentage_24h!==null).sort((a,b)=>b.price_change_percentage_24h-a.price_change_percentage_24h);
    const topGainers=sorted.slice(0,5);
    const topLosers=sorted.slice(-5).reverse();
    topGainers.forEach(c=>{const tr=document.createElement("tr");tr.innerHTML=`<td>${c.name}</td><td>${c.current_price}</td><td style="color:green">${c.price_change_percentage_24h.toFixed(2)}%</td>`;gainersTable.appendChild(tr);});
    topLosers.forEach(c=>{const tr=document.createElement("tr");tr.innerHTML=`<td>${c.name}</td><td>${c.current_price}</td><td style="color:red">${c.price_change_percentage_24h.toFixed(2)}%</td>`;losersTable.appendChild(tr);});

    // --- Update Top Movers ---
    floatingMovers.innerHTML = "";
    [...topGainers,...topLosers].forEach(c=>{const li=document.createElement("li");li.textContent=`${c.name}: ${c.price_change_percentage_24h.toFixed(2)}%`;floatingMovers.appendChild(li);});

    // --- Update All Cryptos with pagination ---
    updateTablePage();

  }catch(e){console.error(e);}
}

function updateTablePage(){
  const query=searchInput.value.toLowerCase();
  const filtered=allCoinsGlobal.filter(c=>c.name.toLowerCase().includes(query));
  const totalPages=Math.ceil(filtered.length/pageSize);
  if(currentPage>totalPages) currentPage=totalPages;
  if(currentPage<1) currentPage=1;

  cryptoTable.innerHTML="";
  const start=(currentPage-1)*pageSize;
  const pageData=filtered.slice(start,start+pageSize);

  pageData.forEach(c=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${c.market_cap_rank}</td><td>${c.name}</td><td>${c.current_price.toLocaleString()}</td><td>${c.price_change_percentage_24h?.toFixed(2)||"0"}%</td><td>${c.price_change_percentage_7d_in_currency?.toFixed(2)||"0"}%</td><td>${c.price_change_percentage_30d_in_currency?.toFixed(2)||"0"}%</td>`;
    cryptoTable.appendChild(tr);
  });

  pageInfo.textContent=`Page ${currentPage} of ${totalPages}`;
}

searchInput.addEventListener("input",()=>{currentPage=1; updateTablePage();});
prevBtn.addEventListener("click",()=>{currentPage--; updateTablePage();});
nextBtn.addEventListener("click",()=>{currentPage++; updateTablePage();});

async function fetchNews(){
  try{
    const res=await fetch("https://api.rss2json.com/v1/api.json?rss_url="+encodeURIComponent("https://www.coindesk.com/arc/outboundfeeds/rss/"));
    const data=await res.json(); newsFeed.innerHTML="";
    data.items.slice(0,5).forEach(item=>{const li=document.createElement("li");li.innerHTML=`<a href="${item.link}" target="_blank">${item.title}</a>`;newsFeed.appendChild(li);});
  }catch(e){console.error(e); newsFeed.innerHTML="<li>Unable to load news</li>";}
}

// Close buttons only
document.querySelectorAll('#floatingMovers, #sideBanner').forEach(widget=>{
  const closeBtn = widget.querySelector('.close');
  closeBtn.addEventListener('click', ()=>{widget.style.display='none';});

  // Make draggable
  let isDragging = false, offsetX = 0, offsetY = 0;
  const header = widget.querySelector('.widget-header');

  header.addEventListener('mousedown', (e)=>{
    isDragging = true;
    offsetX = e.clientX - widget.offsetLeft;
    offsetY = e.clientY - widget.offsetTop;
    widget.style.cursor = 'grabbing';
  });

  document.addEventListener('mousemove', (e)=>{
    if(isDragging){
      widget.style.left = (e.clientX - offsetX) + 'px';
      widget.style.top = (e.clientY - offsetY) + 'px';
    }
  });

  document.addEventListener('mouseup', ()=>{
    if(isDragging){ isDragging=false; widget.style.cursor='move'; }
  });
});

fetchCryptoData();
fetchNews();
setInterval(fetchCryptoData,60000);
setInterval(fetchNews,900000);
</script>

</body>
</html>



